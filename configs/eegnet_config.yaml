# EEGNet-8,2 Configuration
# Based on original FINGER-EEG-BCI paper
# Aligned with paper's online decoding settings

model:
  name: EEGNet-8,2
  F1: 8              # Number of temporal filters
  D: 2               # Depth multiplier
  F2: 16             # F1 Ã— D, pointwise filters
  kernel_length: 64  # Temporal kernel length in samples
  dropout_rate: 0.5

data:
  # Original configuration (128 channels @ 100 Hz)
  sampling_rate: 100     # Hz
  n_channels: 128        # Full BioSemi 128
  window_length: 5.0     # seconds (offline trial duration)

  # Sliding window settings (for online decoding simulation)
  segment_length: 1.0    # seconds (1s sliding window)
  segment_step: 0.125    # seconds (125ms step = 8Hz update rate)

  # Filtering (aligned with original paper)
  bandpass_low: 4.0      # Hz (paper uses 4-40Hz)
  bandpass_high: 40.0    # Hz
  notch_freq: null       # Paper doesn't use notch filter for online

  # Normalization (paper uses z-score per segment)
  normalize: zscore      # 'zscore' or 'divide' or null
  normalize_by: null     # Not used when normalize='zscore'

training:
  epochs: 300           # Paper uses 300 epochs for pre-training
  batch_size: 64        # Increased from 32 for better GPU utilization
  optimizer: Adam
  learning_rate: 1.0e-3
  weight_decay: 0

  # Early stopping
  early_stopping: true
  patience: 4           # Stop if no improvement for 5 epochs
  min_delta: 0.001

  # Learning rate scheduler (aligned with official implementation)
  scheduler: plateau    # ReduceLROnPlateau: factor=0.5, patience=30

# Data split for cross-subject experiments (NOT used for within-subject)
subjects:
  train: [S01, S02, S03, S04, S05, S06, S07, S08, S09, S10, S11, S12, S13, S14]
  val: [S15, S16, S17]
  test: [S18, S19, S20, S21]

# NOTE: For within-subject training (paper-aligned), use:
#   uv run python -m src.training.train_within_subject --subject S01 --task binary
# This trains individual models per subject using 80/20 train/val split

# Classification tasks
tasks:
  binary:
    classes: [1, 4]  # Thumb vs Pinky
    n_classes: 2
  ternary:
    classes: [1, 2, 4]  # Thumb vs Index vs Pinky
    n_classes: 3
  quaternary:
    classes: [1, 2, 3, 4]  # All four fingers
    n_classes: 4

# Logging and checkpointing
logging:
  log_dir: results/logs/eegnet
  log_interval: 10  # batches

checkpointing:
  save_dir: checkpoints/eegnet
  save_best: true
  save_last: true
